<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:b="http://bootsfaces.net/ui">

    <ui:composition template="../template.xhtml">


        <ui:define name="title">
            <h:outputText value="#{bundle.ListUserTitle}"></h:outputText>
        </ui:define>

        <ui:define name="body" >
            <b:tabView id="tabview"  >
                <b:tab title="Creation du Redevable" id="tab" >

                    <div class="col-lg-12" >
                        <div class="col-lg-6" style="margin-top: 2%" >
                            <div Class="ui-grid ui-grid-responsive" >
                                <div Class="ui-grid-row" >
                                    <div Class="ui-grid-col-6 center-block" style="float: right" >
                                        <h:form id="ProprietaireCreateForm"  >
                                            <p:fieldset legend="Information du Proprietaire" style="background-color:lightyellow" >
                                                <b:panelGrid columns="2" class="form-group-sm" >
                                                    <h:outputLabel value="Type d'entité" />
                                                    <p:selectOneMenu id="typeEntite" value="#{localeController.typeRedevable}" >
                                                        <f:selectItem itemValue="1" itemLabel="Personne Physique"/>
                                                        <f:selectItem itemValue="2" itemLabel="Personne morale"/>
                                                        <p:ajax update="ProprietaireCreateForm" />
                                                    </p:selectOneMenu>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_rc}" for="rc" rendered="#{localeController.typeRedevable==2}" />
                                                    <b:inputText id="rc" value="#{localeController.proprietaire .rc}" title="#{bundle.CreateRedevableTitle_rc}" rendered="#{localeController.typeRedevable==2}"/>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_cin}" for="cin" rendered="#{localeController.typeRedevable==1}" />
                                                    <b:inputText id="cin" value="#{localeController.proprietaire .cin}" title="#{bundle.CreateRedevableTitle_cin}" rendered="#{localeController.typeRedevable==1}"/>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_nom}" for="nom" />
                                                    <b:inputText id="nom" value="#{localeController.proprietaire .nom}" title="#{bundle.CreateRedevableTitle_nom}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_prenom}" for="prenom" rendered="#{localeController.typeRedevable==1}" />
                                                    <b:inputText id="prenom" value="#{localeController.proprietaire .prenom}" title="#{bundle.CreateRedevableTitle_prenom}" rendered="#{localeController.typeRedevable==1}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_adresse}" for="adresse" />
                                                    <b:inputText id="adresse" value="#{localeController.proprietaire .adresse}" title="#{bundle.CreateRedevableTitle_adresse}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_email}" for="email" />
                                                    <b:inputText id="email" required="true" 
                                                                 requiredMessage="Please enter your email address."
                                                                 validatorMessage="Invalid email format"
                                                                 value="#{localeController.proprietaire .email}">
                                                        <f:validateRegex
                                                            pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                                                    </b:inputText>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_fax}" for="fax" />
                                                    <b:inputText id="fax" value="#{localeController.proprietaire .fax}" title="#{bundle.CreateRedevableTitle_fax}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_pattente}" for="pattente" />
                                                    <b:inputText id="pattente" value="#{localeController.proprietaire .pattente}" title="#{bundle.CreateRedevableTitle_pattente}" />
                                                </b:panelGrid>
                                                <b:commandButton actionListener="#{localeController.createProprietaire()}" value="#{bundle.Save}" update=":growl" />
                                            </p:fieldset>
                                        </h:form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6" style="margin-top: 2%" >
                            <div Class="ui-grid ui-grid-responsive" >
                                <div Class="ui-grid-row" >
                                    <div Class="ui-grid-col-6 center-block" >
                                        <h:form id="GerantCreateForm">
                                            <p:fieldset legend="Information du Gerant" style="background-color:lightyellow" >
                                                <b:panelGrid columns="2" class="form-group-sm" >
                                                    <h:outputLabel value="Type d'entité" />
                                                    <p:selectOneMenu id="typeEntite" value="#{localeController.typeRedevable}" >
                                                        <f:selectItem itemValue="1" itemLabel="Personne Physique"/>
                                                        <f:selectItem itemValue="2" itemLabel="Personne morale"/>
                                                        <p:ajax update="GerantCreateForm" />
                                                    </p:selectOneMenu>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_rc}" for="rc" rendered="#{localeController.typeRedevable==2}" />
                                                    <b:inputText id="rc" value="#{localeController.gerant .rc}" title="#{bundle.CreateRedevableTitle_rc}" rendered="#{localeController.typeRedevable==2}"/>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_cin}" for="cin" rendered="#{localeController.typeRedevable==1}" />
                                                    <b:inputText id="cin" value="#{localeController.gerant .cin}" title="#{bundle.CreateRedevableTitle_cin}" rendered="#{localeController.typeRedevable==1}"/>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_nom}" for="nom" />
                                                    <b:inputText id="nom" value="#{localeController.gerant .nom}" title="#{bundle.CreateRedevableTitle_nom}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_prenom}" for="prenom" rendered="#{localeController.typeRedevable==1}" />
                                                    <b:inputText id="prenom" value="#{localeController.gerant .prenom}" title="#{bundle.CreateRedevableTitle_prenom}" rendered="#{localeController.typeRedevable==1}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_adresse}" for="adresse" />
                                                    <b:inputText id="adresse" value="#{localeController.gerant .adresse}" title="#{bundle.CreateRedevableTitle_adresse}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_email}" for="email" />
                                                    <b:inputText id="email" required="true" 
                                                                 requiredMessage="Please enter your email address."
                                                                 validatorMessage="Invalid email format"
                                                                 value="#{localeController.gerant .email}">
                                                        <f:validateRegex
                                                            pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                                                    </b:inputText>
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_fax}" for="fax" />
                                                    <b:inputText id="fax" value="#{localeController.gerant .fax}" title="#{bundle.CreateRedevableTitle_fax}" />
                                                    <h:outputLabel value="#{bundle.CreateRedevableLabel_pattente}" for="pattente" />
                                                    <b:inputText id="pattente" value="#{localeController.gerant .pattente}" title="#{bundle.CreateRedevableTitle_pattente}" />
                                                </b:panelGrid>
                                                <b:commandButton actionListener="#{localeController.createGerant()}" value="#{bundle.Save}" update=":growl" />
                                            </p:fieldset>
                                        </h:form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </b:tab>
                <b:tab title="Creation du Locale">

                    <div Class="ui-grid ui-grid-responsive" style="margin-top: 2%">
                        <div Class="ui-grid-row">
                            <div Class="ui-grid-col-6 center-block">
                                <h:form id="redevableCreateForm">
                                    <p:fieldset style="background-color: lightyellow" >
                                        <b:panelGrid columns="3" class="form-group-sm" rendered="#{localeController.selected != null}">
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_proprietaire}" for="proprietaire" />
                                            <b:inputText id="proprietaire" value="#{localeController.proprietaireCinRc}" />
                                            <b:commandButton value="" actionListener="#{localeController.findProprietaireByCinOrRc()}" icon="glyphicon glyphicon-search" update=":LocaleCreateForm:proprietaire,:LocaleCreateForm:save,:growl" />
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_gerant}" for="gerant" />
                                            <b:inputText id="gerant" value="#{localeController.gerantCinRc}" />
                                            <b:commandButton value="" actionListener="#{localeController.findGerantByCinOrRc()}" icon="glyphicon glyphicon-search" update=":LocaleCreateForm:gerant,:LocaleCreateForm:save,:growl"/>
                                        </b:panelGrid>
                                    </p:fieldset>
                                </h:form>
                                <br/>
                                <h:form id="LocaleCreateForm">
                                    <p:fieldset style="background-color: lightyellow">
                                        <b:panelGrid columns="2" rendered="#{localeController.selected != null}">
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_proprietaire} " for="proprietaire" />
                                            <h:outputText id="proprietaire" value="#{localeController.selected.proprietaire.nom}"/>
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_gerant}" for="gerant" />
                                            <h:outputText id="gerant" value="#{localeController.selected.gerant.nom}" />
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_categorie}" for="categorie" />
                                            <p:selectOneMenu id="categorie" value="#{localeController.selected.categorie}" >
                                                <f:selectItems value="#{categorieController.itemsAvailableSelectOne}"
                                                               var="categorieItem"
                                                               itemValue="#{categorieItem}"/>
                                            </p:selectOneMenu>
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_activite}" for="activite" />
                                            <b:inputText id="activite" value="#{localeController.selected.activite}" title="#{bundle.CreateLocaleTitle_activite}" />
                                            <h:outputLabel value="Nom" for="nom" />
                                            <b:inputText id="nom" value="#{localeController.selected.nom}"/>
                                            <h:outputLabel value="secteur" />
                                            <p:selectOneMenu id="secteur"  value="#{localeController.secteur}" filter="true" >
                                                <f:selectItem itemValue="#{null}" itemLabel="--SELECT--"/>
                                                <f:selectItems value="#{secteurController.items}"
                                                               var="secteurItem" 
                                                               itemValue="#{secteurItem}"/>
                                                <p:ajax process="secteur" listener="#{localeController.findAnnexs()}" update="annexAdministratif,quartier,rue" />
                                            </p:selectOneMenu>
                                            <h:outputLabel value="annexAdministratif" />
                                            <p:selectOneMenu id="annexAdministratif"  value="#{localeController.annexeAdministratif}" filter="true" >
                                                <f:selectItem itemValue="#{null}" itemLabel="--SELECT--"/>
                                                <f:selectItems value="#{localeController.secteur.annexeAdministratifs}"
                                                               var="annexAdministratifItem" 
                                                               itemValue="#{annexAdministratifItem}"/>
                                                <p:ajax process="annexAdministratif" listener="#{localeController.findQuartiers()}" update="quartier,rue" />
                                            </p:selectOneMenu>
                                            <h:outputLabel value="quartier" />
                                            <p:selectOneMenu id="quartier"  value="#{localeController.quartier}" filter="true" >
                                                <f:selectItem itemValue="#{null}" itemLabel="--SELECT--"/>
                                                <f:selectItems value="#{localeController.annexeAdministratif.quartiers}"
                                                               var="quartierItem" 
                                                               itemValue="#{quartierItem}"/>
                                                <p:ajax process="quartier" listener="#{localeController.findRues()}" update="rue" />
                                            </p:selectOneMenu>
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_rue}" for="rue" />
                                            <p:selectOneMenu id="rue" value="#{localeController.selected.rue}" filter="true" >
                                                <f:selectItem itemValue="#{null}" itemLabel="--SELECT--"/>
                                                <f:selectItems value="#{localeController.quartier.rues}"
                                                               var="rueItem"
                                                               itemValue="#{rueItem}"/>
                                            </p:selectOneMenu>
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_complementAdresse}" for="complementAdresse" />
                                            <b:inputText id="complementAdresse" value="#{localeController.selected.complementAdresse}" title="#{bundle.CreateLocaleTitle_complementAdresse}" />
                                            <h:outputLabel value="#{bundle.CreateLocaleLabel_description}" for="description" />
                                            <b:inputText id="description" value="#{localeController.selected.description}" title="#{bundle.CreateLocaleTitle_description}" />
                                        </b:panelGrid>
                                        <b:commandButton id="save" actionListener="#{localeController.create}" value="#{bundle.Save}" update=":growl"  
                                                         disabled="#{empty localeController.selected.gerant.id or empty localeController.selected.proprietaire.id or empty localeController.selected.rue.id}"/>
                                    </p:fieldset>
                                </h:form>
                            </div>
                        </div>
                    </div>

                </b:tab>
            </b:tabView>
        </ui:define>
    </ui:composition>

</html>
